{
    "appid": "a1ab9a21-0b2e-4e21-9af7-7901ba97c599",
    "name": "McAfee Advanced Threat Defense (ATD)",
    "description": "This app supports executing investigative actions like 'detonate file' to analyze executables on the McAfee ATD appliance",
    "publisher": "Martin Ohl",
    "package_name": "phantom_atd",
    "type": "threat intel",
    "license": "Copyright (c) Martin Ohl 2017",
    "main_module": "atd_connector.pyc",
    "app_version": "1.0",
    "utctime_updated": "2017-03-10T07:09:42.000000Z",
    "product_vendor": "McAfee",
    "product_name": "ATD",
    "product_version_regex": ".*",
    "min_phantom_version": "1.2.236",
    "logo": "atd.png",
    "configuration": {
          "atd_ip": {
            "description": "McAfee ATD IP/URL",
            "data_type": "string",
            "required": false,
            "order": 0
          },
          "atd_user": {
            "description": "Username",
            "data_type": "string",
            "required": false,
            "order": 1
          },
          "atd_pw": {
            "description": "Password",
            "data_type": "password",
            "required": false,
            "order": 2
          },
          "atd_profile": {
            "description": "Profile ID",
            "data_type": "numeric",
            "required": false,
            "order": 3
          }
    },
    "actions": [
      {
        "action": "test connectivity",
        "description": "Validate the ATD connectivity",
        "type": "test",
        "identifier": "test_asset_connectivity",
        "read_only": true,
        "parameters": {
        },
        "output": [],
        "versions":"EQ(*)"
      },
      {
        "action" : "detonate file",
        "description": "Run the file in the McAfee ATD and retrieve the analysis results",
        "verbose": "This action requires the input file to be present in the vault and therefore takes the vault id as the input parameter.",
        "type": "investigate",
        "identifier": "detonate_file",
        "read_only": true,
        "lock": {
          "enable": false
           },
        "parameters": {
          "vault_id": {
            "description": "Vault ID of file to detonate",
            "data_type": "string",
            "order": 0,
            "contains": ["vault id", "pe file"],
            "primary": true,
            "required": true
          }
        },
        "render": {
          "width": 12,
          "title": "Detonate File",
          "type": "table",
          "height": 5
        },
        "output": [
          {
            "data_path": "action_result.data.*.Summary.Ips.*.Ipv4",
            "data_type": "string",
            "contains": [
              "ip"
            ]
          },
          {
            "data_path": "action_result.data.*.Summary.Ips.*.Port",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Ips.*.Risk",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Ips.*.Category",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Ips.*.Severity",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Ips.*.Processes.*.Name",
            "data_type": "string",
            "contains": [
              "file name"
            ]
          },
          {
            "data_path": "action_result.data.*.Summary.Ips.*.Processes.*.Sha256",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Ips.*.Processes.*.RelType",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Ips.*.Functional",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Ips.*.Reputation",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Bait",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Data.compiled_with",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Data.analysis_seconds",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Data.sandbox_analysis",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Urls.*.Url",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Urls.*.Port",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Urls.*.Risk",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Urls.*.Category",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Urls.*.Severity",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Urls.*.Processes.*.Name",
            "data_type": "string",
            "contains": [
              "file name"
            ]
          },
          {
            "data_path": "action_result.data.*.Summary.Urls.*.Processes.*.Sha256",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Urls.*.Processes.*.RelType",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Urls.*.Functional",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Urls.*.Reputation",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Files.*.Md5",
            "data_type": "string",
            "contains": [
              "md5"
            ]
          },
          {
            "data_path": "action_result.data.*.Summary.Files.*.Name",
            "data_type": "string",
            "contains": [
              "sha1"
            ]
          },
          {
            "data_path": "action_result.data.*.Summary.Files.*.Sha1",
            "data_type": "string",
            "contains": [
              "sha1"
            ]
          },
          {
            "data_path": "action_result.data.*.Summary.Files.*.Sha256",
            "data_type": "string",
            "contains": [
              "sha256"
            ]
          },
          {
            "data_path": "action_result.data.*.Summary.Files.*.FileType",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Files.*.Processes.*.Name",
            "data_type": "string",
            "contains": [
              "sha1"
            ]
          },
          {
            "data_path": "action_result.data.*.Summary.Files.*.Processes.*.Sha256",
            "data_type": "string",
            "contains": [
              "sha256"
            ]
          },
          {
            "data_path": "action_result.data.*.Summary.Files.*.Processes.*.RelType",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Stats.*.ID",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Stats.*.Category",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Stats.*.Severity",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Process.*.Name",
            "data_type": "string",
            "contains": [
              "sha1"
            ]
          },
          {
            "data_path": "action_result.data.*.Summary.Process.*.Reason",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Process.*.Severity",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Subject.md5",
            "data_type": "string",
            "contains": [
              "md5"
            ]
          },
          {
            "data_path": "action_result.data.*.Summary.Subject.Name",
            "data_type": "string",
            "contains": [
              "sha1"
            ]
          },
          {
            "data_path": "action_result.data.*.Summary.Subject.Type",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Subject.size",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Subject.sha-1",
            "data_type": "string",
            "contains": [
              "sha1"
            ]
          },
          {
            "data_path": "action_result.data.*.Summary.Subject.sha-256",
            "data_type": "string",
            "contains": [
              "sha256"
            ]
          },
          {
            "data_path": "action_result.data.*.Summary.Subject.FileType",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Subject.Timestamp",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Subject.parent_archive",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Verdict.Severity",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Verdict.Description",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Behavior",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.OSversion",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Processes.*.Name",
            "data_type": "string",
            "contains": [
              "sha1"
            ]
          },
          {
            "data_path": "action_result.data.*.Summary.Processes.*.Run-Time Dlls.*.DLL Loaded",
            "data_type": "string",
            "contains": [
              "file name"
            ]
          },
          {
            "data_path": "action_result.data.*.Summary.Processes.*.File Operations.*.Other",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Processes.*.File Operations.*.Files Read",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Processes.*.File Operations.*.Files Copied",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Processes.*.File Operations.*.Files Opened",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Processes.*.File Operations.*.Files Created",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Processes.*.File Operations.*.Files Deleted",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Processes.*.File Operations.*.Files Modified",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Processes.*.Other Operations.*.Others",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Processes.*.Process Operations.*.Other",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Processes.*.Process Operations.*.Thread Created",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Processes.*.Process Operations.*.Process Created",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Processes.*.Registry Operations.*.Registry Read",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Processes.*.Registry Operations.*.Registry Opened",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Processes.*.Registry Operations.*.Registry Created",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Processes.*.Registry Operations.*.Registry Modified",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Processes.*.Network Operations.*.Other",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Processes.*.Process Operations.*.Process killed",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Selectors.*.Engine",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Selectors.*.Severity",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Selectors.*.MalwareName",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.DETversion",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.MISversion",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Properties.comments",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Properties.copyright",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Properties.publisher",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Properties.signature",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Properties.description",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Properties.strong_name",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Properties.file_version",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Properties.product_name",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Properties.version_info",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Properties.internal_name",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Properties.original_name",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.SUMversion",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Attachments",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.Environment",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.JSONversion",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.URL_Reputation.*.url",
            "data_type": "string",
            "contains": [
              "ip"
            ]
          },
          {
            "data_path": "action_result.data.*.Summary.URL_Reputation.*.port",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.URL_Reputation.*.risk",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.URL_Reputation.*.category",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.URL_Reputation.*.severity",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.URL_Reputation.*.functional",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.URL_Reputation.*.reputation",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Summary.hasDynamicAnalysis",
            "data_type": "string"
          },
          {
            "data_path": "action_result.status",
            "data_type": "string"
          },
          {
            "data_path": "action_result.message",
            "data_type": "string"
          },
          {
            "data_path": "action_result.summary.date",
            "data_type": "string",
            "column_name": "Timestamp",
            "column_order": 1
          },
          {
            "data_path": "action_result.summary.name",
            "data_type": "string",
            "column_name": "Filename",
            "column_order": 2
          },
          {
            "data_path": "action_result.summary.sha1",
            "data_type": "string",
            "column_name": "SHA1",
            "column_order": 3
          },
          {
            "data_path": "action_result.summary.size",
            "data_type": "string",
            "column_name": "Filesize",
            "column_order": 4
          },
          {
            "data_path": "action_result.summary.type",
            "data_type": "string",
            "column_name": "Filetype",
            "column_order": 5
          },
          {
            "data_path": "action_result.summary.verdict",
            "data_type": "string",
            "column_name": "Verdict",
            "column_order": 6
          },
          {
            "data_path": "action_result.summary.severity",
            "data_type": "string",
            "column_name": "Severity",
            "column_order": 7
          },
          {
            "data_path": "action_result.parameter.vault_id",
            "data_type": "string"
          },
          {
            "data_path": "summary.total_objects",
            "data_type": "numeric"
          },
          {
            "data_path": "summary.total_objects_successful",
            "data_type": "numeric"
          }
        ],
        "versions":"EQ(*)"
      }
    ]
}
